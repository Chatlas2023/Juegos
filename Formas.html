<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Elimina los Objetos</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            touch-action: manipulation;
            font-family: Arial, sans-serif;
            background-color: white;
            color: #333;
            user-select: none;
            -webkit-user-select: none;
        }
        
        #gameArea {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: white;
        }
        
        .object-container {
            position: absolute;
            cursor: pointer;
            touch-action: manipulation;
            transition: transform 0.2s ease-in-out;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .object-hitbox {
            width: 100%;
            height: 100%;
            position: absolute;
            z-index: 2;
        }
        
        .object-image {
            position: relative;
            z-index: 1;
            pointer-events: none;
            max-width: 100%;
            max-height: 100%;
        }
        
        .object-container:hover {
            transform: scale(1.1);
        }
        
        #scorePanel {
            position: fixed;
            top: 20px;
            left: 10px;
            background-color: rgba(240, 240, 240, 0.8);
            padding: 10px;
            border-radius: 5px;
            font-size: 16px;
            z-index: 100;
            color: #333;
            border: 1px solid #ccc;
        }
        
        #gameOver {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(240, 240, 240, 0.9); 
            color: #333;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            display: none;
            z-index: 200;
            border: 1px solid #ccc;
            width: 80%;
            max-width: 300px;
        }
        
        #restartButton {
            background-color: #4CAF50;
            border: none;
            color: white;
            padding: 12px 24px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin-top: 15px;
            cursor: pointer;
            border-radius: 5px;
            width: 100%;
        }
        
        #safeArea {
            position: absolute;
            top: 50px;
            left: 10px;
            right: 10px;
            bottom: 50px;
        }
    </style>
</head>
<body>
    <div id="gameArea">
        <div id="safeArea"></div>
    </div>
    
    <div id="scorePanel">
        Puntuación: <span id="score">0</span><br>
        Mejor Puntuación: <span id="topScore">0</span>
    </div>
    
    <div id="gameOver">
        <h2>¡Juego Terminado!</h2>
        <p>Tu puntuación: <span id="finalScore">0</span></p>
        <p>Mejor puntuación: <span id="finalTopScore">0</span></p>
        <button id="restartButton">Jugar de Nuevo</button>
    </div>

    <script>
        // Variables del juego
        let score = 0;
        let topScore = localStorage.getItem('topScore') || 0;
        let gameSpeed = 1000; // ms entre objetos
        let gameActive = true;
        let objectsOnScreen = 0;
        const maxObjects = 10; // Máximo de objetos en pantalla simultáneamente
        const safeAreaMargin = 50; // Margen seguro para evitar bordes
        const imageCount = 18; // Número de imágenes disponibles (01.png a 18.png)
        const hitboxScale = 1.5; // Factor de escala para el área de toque
        
        // Elementos del DOM
        const gameArea = document.getElementById('gameArea');
        let safeArea = document.getElementById('safeArea');
        const scoreElement = document.getElementById('score');
        const topScoreElement = document.getElementById('topScore');
        const gameOverElement = document.getElementById('gameOver');
        const finalScoreElement = document.getElementById('finalScore');
        const finalTopScoreElement = document.getElementById('finalTopScore');
        const restartButton = document.getElementById('restartButton');
        
        // Actualizar la mejor puntuación mostrada
        topScoreElement.textContent = topScore;
        
        // Iniciar el juego
        startGame();
        
        function startGame() {
            gameActive = true;
            score = 0;
            gameSpeed = 1000;
            objectsOnScreen = 0;
            scoreElement.textContent = score;
            gameOverElement.style.display = 'none';
            
            // Limpiar cualquier objeto existente
            gameArea.innerHTML = '<div id="safeArea"></div>';
            safeArea = document.getElementById('safeArea');
            
            // Iniciar el ciclo del juego
            spawnObject();
        }
        
        function spawnObject() {
            if (!gameActive || objectsOnScreen >= maxObjects) {
                if (gameActive) {
                    setTimeout(spawnObject, gameSpeed);
                }
                return;
            }
            
            const container = document.createElement('div');
            container.className = 'object-container';
            
            // Tamaño aleatorio (más grande para mejor interacción táctil)
            const size = Math.floor(Math.random() * 40) + 80;
            
            // Obtener dimensiones del área segura
            const safeAreaRect = safeArea.getBoundingClientRect();
            const safeAreaWidth = safeAreaRect.width;
            const safeAreaHeight = safeAreaRect.height;
            
            // Posición inicial aleatoria dentro del área segura
            const maxX = safeAreaWidth - size;
            const maxY = safeAreaHeight - size;
            
            if (maxX <= 0 || maxY <= 0) {
                setTimeout(spawnObject, 100);
                return;
            }
            
            const startX = Math.floor(Math.random() * maxX) + safeAreaRect.left;
            const startY = Math.floor(Math.random() * maxY) + safeAreaRect.top;
            
            // Seleccionar imagen aleatoria
            const imageNumber = Math.floor(Math.random() * imageCount) + 1;
            const imageName = `${imageNumber.toString().padStart(2, '0')}.png`;
            
            // Crear elementos de imagen y área de toque
            const hitbox = document.createElement('div');
            hitbox.className = 'object-hitbox';
            
            const img = document.createElement('img');
            img.className = 'object-image';
            img.src = imageName;
            img.alt = `Objeto ${imageNumber}`;
            
            // Establecer tamaño del contenedor
            container.style.width = `${size}px`;
            container.style.height = `${size}px`;
            container.style.left = `${startX}px`;
            container.style.top = `${startY}px`;
            
            // Hacer el área de toque más grande que la imagen
            hitbox.style.width = `${size * hitboxScale}px`;
            hitbox.style.height = `${size * hitboxScale}px`;
            hitbox.style.marginLeft = `${-size * (hitboxScale - 1) / 2}px`;
            hitbox.style.marginTop = `${-size * (hitboxScale - 1) / 2}px`;
            
            // Añadir elementos al contenedor
            container.appendChild(img);
            container.appendChild(hitbox);
            
            // Velocidad y dirección de movimiento aleatorios
            const speedX = (Math.random() - 0.5) * 4;
            const speedY = (Math.random() - 0.5) * 4;
            
            // Evento para eliminar el objeto al tocarlo
            hitbox.addEventListener('click', function() {
                if (!gameActive) return;
                
                // Eliminar el objeto
                gameArea.removeChild(container);
                objectsOnScreen--;
                
                // Aumentar puntuación
                score++;
                scoreElement.textContent = score;
                
                // Aumentar dificultad gradualmente
                if (score % 5 === 0 && gameSpeed > 200) {
                    gameSpeed -= 50;
                }
            });
            
            // También permitir tocar en cualquier parte del contenedor
            container.addEventListener('click', function(e) {
                if (!gameActive) return;
                e.stopPropagation();
                
                // Eliminar el objeto
                gameArea.removeChild(container);
                objectsOnScreen--;
                
                // Aumentar puntuación
                score++;
                scoreElement.textContent = score;
                
                // Aumentar dificultad gradualmente
                if (score % 5 === 0 && gameSpeed > 200) {
                    gameSpeed -= 50;
                }
            });
            
            // Añadir objeto al área de juego
            gameArea.appendChild(container);
            objectsOnScreen++;
            
            // Mover el objeto
            let posX = startX;
            let posY = startY;
            let currentSpeedX = speedX;
            let currentSpeedY = speedY;
            
            function moveObject() {
                if (!gameActive) return;
                
                posX += currentSpeedX;
                posY += currentSpeedY;
                
                // Rebotar en los bordes del área segura
                if (posX <= safeAreaRect.left || posX >= safeAreaRect.left + safeAreaWidth - size) {
                    currentSpeedX = -currentSpeedX;
                    posX = Math.max(safeAreaRect.left, Math.min(posX, safeAreaRect.left + safeAreaWidth - size));
                }
                if (posY <= safeAreaRect.top || posY >= safeAreaRect.top + safeAreaHeight - size) {
                    currentSpeedY = -currentSpeedY;
                    posY = Math.max(safeAreaRect.top, Math.min(posY, safeAreaRect.top + safeAreaHeight - size));
                }
                
                container.style.left = `${posX}px`;
                container.style.top = `${posY}px`;
                
                requestAnimationFrame(moveObject);
            }
            
            moveObject();
            
            // Eliminar objeto después de un tiempo si no se toca
            setTimeout(() => {
                if (gameArea.contains(container)) {
                    gameArea.removeChild(container);
                    objectsOnScreen--;
                    endGame();
                }
            }, 5000);
            
            // Generar siguiente objeto
            if (gameActive) {
                setTimeout(spawnObject, gameSpeed);
            }
        }
        
        function endGame() {
            if (!gameActive) return;
            
            gameActive = false;
            
            // Actualizar mejor puntuación
            if (score > topScore) {
                topScore = score;
                localStorage.setItem('topScore', topScore);
                topScoreElement.textContent = topScore;
            }
            
            // Mostrar pantalla de fin de juego
            finalScoreElement.textContent = score;
            finalTopScoreElement.textContent = topScore;
            gameOverElement.style.display = 'block';
        }
        
        // Evento para el botón de reinicio
        restartButton.addEventListener('click', startGame);
        
        // Evitar el desplazamiento táctil no deseado
        document.addEventListener('touchmove', function(e) {
            if (gameActive) {
                e.preventDefault();
            }
        }, { passive: false });
        
        // Ajustar el área segura cuando cambia el tamaño de la pantalla
        window.addEventListener('resize', function() {
            if (safeArea) {
                const safeAreaRect = safeArea.getBoundingClientRect();
            }
        });
    </script>
</body>
</html>
